<apex:page html-class="active-policies" showHeader="false" sidebar="false" standardStylesheets="false" controller="SL_AllActivePoliciesController" action="{!pageAction}">
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<style>
		.approve-edit,
		.deny-edit {
			display: none;
		}
		.hidden {
			display: none;
		}
	</style>
	<script type="text/javascript">
		function updatePolicy(id) {
			var elem = document.getElementById('span_'+id);
			SL_AllActivePoliciesController.updatePolicyDescription(
				id,
				elem.innerText.trim(),
				function(result, event) {
					elem.innerHTML = result;
				}
			);
		}
	</script>
	<!-- Start of Page -->
	<apex:composition template="SL_SiteTemplate">
		<!-- Start of Main section -->  
		<apex:define name="mainSection">
			<!-- main-content div Start -->
			<div id="main-content" class="span9" style="margin-left: 0em;" >
			<!-- welcome message goes in here -->
			<h1 class="welcome">Your Active Policies</h1>
			<hr />
			<!-- bread crumb goes here -->
			<div class="row-fluid crumb-container">
				<apex:outputPanel rendered="{!IF($Profile.Name == 'Pure Customer Community Login User', true, false)}">
					<ul class="breadcrumb pure-crumb">
						<li><a style="cursor: pointer;"  onclick="window.open('/MemberHomePage', '_self');">pure</a> <span class="divider">/</span></li>
						<li class="active">policies</li>
					</ul>
				</apex:outputPanel>
				<apex:outputPanel rendered="{!IF($Profile.Name != 'Pure Customer Community Login User', true, false)}">
					<ul class="breadcrumb pure-crumb">
						<li><a style="cursor: pointer;"  onclick="window.open('/BrokerView/MemberHomePage?mId={!$CurrentPage.parameters.mId}', '_self');">pure</a> <span class="divider">/</span></li>
						<li class="active">policies</li>
					</ul>
				</apex:outputPanel>
			</div>	
			<!-- member-info goes here -->
			<div id="member-info" class="row-fluid">
				<div class="span12">
					<div class="row-fluid">
						<dl class="span6">
							<dt>MEMBER NAME:</dt>
							<dd><div style="width:95%; word-wrap: break-word;">{!member.Name}</div></dd>
						</dl>
						<dl class="span6">
							<dt>MEMBER ID:</dt>
							<dd>{!member.Member_Key_EDW__c}</dd>
						</dl>
					</div>
				</div>
			</div>
			<!-- Active policies fill in table below. If none, hide. -->
			<div class="default-full-table row-fluid">
				<div class="span12">        
					<div class="table-header arrow-container">
						<h1 >Your Active Policies</h1>
						<div class="rotate-caret mobile"><i class="fa fa-caret-right fa-2x"></i></div>
					</div>
					<apex:outputpanel rendered="{!If(policies.size == 0, true,false)}">
						<table class="table policies-desktop table-striped">
							<tr style="width:100%;">
								<td class="center-icon" colspan="5" style="width:100%; ">
									<span >No Active Policies are present for this Member.</span>
								</td>
							</tr>
						</table>
					</apex:outputpanel>
					<!-- Active policies mobile table ("desktop" version is removed on mobile, this is displayed.) if none, hide.-->
					<div class="mobile-expandable-div policies-mobile">
						<apex:outputpanel rendered="{!If(policies.size == 0, true,false)}">
							<div class="mobile-policy-container">
								<ul>
									<li>
										No Active Policies are present for this Member.
									</li>
								</ul>
							</div>
						</apex:outputpanel>
						<apex:outputpanel rendered="{!If(policies.size > 0, true,false)}">
							<apex:repeat value="{!policies}" var="AP">
								<div class="mobile-policy-container">
									<ul>
										<li class="Lgray">
											<h3>POLICY TYPE</h3>
											<p><img id="theImage" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/'+AP.policyType+'.png')}" /></p>
										</li>
										<li class="Dgray">
											<h3>POLICY NUMBER</h3>
											<apex:outputPanel rendered="{!IF($Profile.Name == 'Pure Customer Community Login User', true, false)}">
												<p><a style="cursor: pointer;" onclick="window.open('/PolicyDetailPage?url='+'{!AP.policyNumber}', '_self');">{!AP.policyNumber}</a>
												</p>
											</apex:outputPanel>
											<apex:outputPanel rendered="{!IF($Profile.Name != 'Pure Customer Community Login User', true, false)}">
												<p><a style="cursor: pointer;" onclick="window.open('/BrokerView/PolicyDetailPage?url='+'{!AP.policyNumber}?mId={!$CurrentPage.parameters.mId}', '_self');">{!AP.policyNumber}</a>
												</p>
											</apex:outputPanel>

										</li>
										<li class="Lgray">
											<h3>DESCRIPTION</h3>
											<p>{!AP.policyDescription}</p>
										</li>
										<li class="Dgray">
											<h3>POLICY PERIOD</h3>
											<p><apex:outputText value="{0,date,MM/dd/yy}"><apex:param value="{!AP.policyEffectiveDate}" />
												</apex:outputText>&nbsp;-&nbsp;<apex:outputText value="{0,date,MM/dd/yy}"><apex:param value="{!AP.policyEndDate}" />
												</apex:outputText>
											</p>
										</li>
										<li class="Lgray">
											<h3>DOWNLOAD POLICY</h3>
											<p><apex:outputPanel rendered="{!IF(AP.policyDownloadLink == null,false,(If(AP.policyDownloadLink == '',false,true)))}">
											<a href="{!AP.policyDownloadLink}" target="_blank"><i class="fa fa-file-text-o fa-1x"></i></a>
										</apex:outputPanel></p>
										</li>
									</ul>
								</div>
							</apex:repeat>
						</apex:outputpanel>
						<apex:outputPanel rendered="{!member.In_Force_Flood_Policy__c}">
							<div class="mobile-policy-container">
								<ul>
									<li class="Lgray">
										<h3>POLICY TYPE</h3>
										<p><img id="theImage" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/flood.png')}" /></p>
									</li>
									<li class="Dgray">
										<h3>POLICY NUMBER</h3>
										<p>N/A <a style="cursor: pointer;" class="has-popover" data-toggle="popover" data-placement="right" data-content="Pure's Primary Flood Coverage is administered by National Flood Solutions (NFS). For specific details on your coverage, contact your broker." title="" href="#"><i class="icon fa fa-info-circle"></i></a></p>  
									</li>
									<li class="Lgray">
										<h3>DESCRIPTION</h3>
										<p>Flood</p>
									</li>
								</ul>
							</div>
						</apex:outputPanel>
					</div>
					<apex:outputpanel rendered="{!If(policies.size > 0, true,false)}">
						<table class="table policies-desktop table-striped">
							<thead>
								<tr>
									<th class="type active-policy-icon-column">Policy<br/>Type</th>
									<th class="number">Policy Number</th>
									<th class="description">Description</th>
									<th class="period" >Policy Period</th>
									<th>Download Policy</th>
								</tr> 
							</thead>
							<tbody>
								<apex:repeat value="{!policies}" var="AP">
									<tr> 
										<td class="center-icon active-policy-icon-column">
											<img id="theImage" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/'+AP.policyType+'.png')}" />
										</td>
										<apex:outputPanel rendered="{!IF($Profile.Name == 'Pure Customer Community Login User', true, false)}">
											<td><a style="cursor: pointer;" onclick="window.open('/PolicyDetailPage?url='+'{!AP.policyNumber}', '_self');">{!AP.policyNumber}</a>
											</td>
										</apex:outputPanel>
										<apex:outputPanel rendered="{!IF($Profile.Name != 'Pure Customer Community Login User', true, false)}">
											<td><a style="cursor: pointer;" onclick="window.open('/BrokerView/PolicyDetailPage?url='+'{!AP.policyNumber}'+'&mId='+'{!$CurrentPage.parameters.mId}', '_self');">{!AP.policyNumber}</a>
											</td>
										</apex:outputPanel>
										<td>
											<apex:outputpanel rendered="{!If((AP.policyType == 'flood'),true,false)}">
												{!AP.policyDescription}
											</apex:outputpanel>
											<apex:outputpanel rendered="{!If((AP.policyType == 'flood'),false,true)}">
												<span class="edit-info" id="span_{!AP.policyId}">{!AP.policyDescription}</span>
												<a style="display:{!If($Profile.Name != 'Pure Customer Community Login User','none;','')}" href="" data-toggle="tooltip" data-placement="right" title="" data-original-title="Personalize your Policy names" class="bracket-link has-tooltip">[<i class="edit-icon icon icon-resize fa fa-pencil"></i><i onclick="updatePolicy('{!AP.policyId}');" class="approve-edit icon icon-resize fa fa-check"></i><i class="deny-edit icon icon-resize fa fa-times" style="color:red;"></i>]</a>
											</apex:outputpanel>
										</td>
										<td>
											<apex:outputText value="{0,date,MM/dd/yy}"><apex:param value="{!AP.policyEffectiveDate}" /></apex:outputText>&nbsp;-&nbsp;<apex:outputText value="{0,date,MM/dd/yy}"><apex:param value="{!AP.policyEndDate}" /></apex:outputText>
										</td>
										<td class="center-icon">
											<apex:outputPanel rendered="{!IF(AP.policyDownloadLink == null,false,(If(AP.policyDownloadLink == '',false,true)))}">
												<a href="{!AP.policyDownloadLink}" target="_blank"><i class="fa fa-file-text-o fa-1x"></i></a>
											</apex:outputPanel>
										</td>
									</tr>
								</apex:repeat>
								<apex:outputPanel rendered="{!member.In_Force_Flood_Policy__c}">
									<tr> 
										<td class="center-icon active-policy-icon-column">
											<img id="theImage" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/flood.png')}" />
										</td>
										<td>N/A <a style="cursor: pointer;" class="has-popover" data-toggle="popover" data-placement="right" data-content="Pure's Primary Flood Coverage is administered by National Flood Solutions (NFS). For specific details on your coverage, contact your broker." title="" href="#"><i class="icon fa fa-info-circle"></i></a>
										</td>
										<td>Flood</td>
										<td></td>
										<td></td>
									</tr>
								</apex:outputPanel>
							</tbody>
						</table>
					</apex:outputpanel>
				</div>
			</div>
				<!-- End Active policies fill in table below. If none, hide. -->
				<p class="table-header-sub">
					For information pertaining to a policy that is no longer active, contact Members Services by <a  href="mailto:service@pureinsurance.com?Subject={!strEmailSubject}" style="display:{!If($Profile.Name != 'Pure Customer Community Login User','','none;')};cursor:not-allowed;text-decoration:none;pointer-events: none;
				">Email</a><a style="display:{!If(NOT($Profile.Name != 'Pure Customer Community Login User'),'','none;')}" href="mailto:service@pureinsurance.com?Subject={!strEmailSubject}">Email</a> or at (888) 813-7873.
				</p>
				<div class="unit-full-container row-fluid">
					<div class="span12 unit-content">   
						<div class="unit-full-title">
							<h1>PUREâ€™s Product Suite</h1>
						</div>
						<p class="unit-full-sub-header">In addition to the coverages that you are already taking advantage of, PURE offers the following:</p>
					<!-- If user owns a policy, you need to apply the class 'user-owns-this-policy' to the <li> tag in the ul#product-suite. This way it will be greyed out, and they will see other policies they can buy. -->
						<ul id="product-suite">
							<li id="homeowners" >
								<a  href='{!homeownerPolicyLink}' target="_blank">
									<div class="product-suite-image-container">
										<img class="top-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-01.png')}" />
										<img class="grey-icon under-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-gray-01.png')}" />
									</div>
									<span class="product-suite-text">HOMEOWNERS</span>
								</a>
							</li>
							<li id="auto" >
								<a  href='{!autoPolicyLink}' target="_blank">
									<div class="product-suite-image-container">
										<img class="top-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-02.png')}" />
										<img class="grey-icon under-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-gray-02.png')}" />
									</div>
									<span class="product-suite-text">AUTO</span>
								</a>
							</li>
							<li id="jewelry" >
								<a  href='{!collectionPolicyLink}' target="_blank">
									<div class="product-suite-image-container">
										<img class="top-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-03.png')}" />
										<img class="grey-icon under-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-gray-03.png')}" />
									</div>
									<span class="product-suite-text">JEWELRY ART &amp; COLLECTIONS</span>
								</a>
							</li>
							<li id="personl-excess" >
								<a  href='{!excessPolicyLink}' target="_blank">
									<div class="product-suite-image-container">
										<img class="top-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-04.png')}" />
										<img class="grey-icon under-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-gray-04.png')}" />
									</div>
									<span class="product-suite-text">PERSONAL EXCESS</span>
								</a>
							</li>
							<li id="watercraft" >
								<a  href='{!watercraftPolicyLink}' target="_blank">
									<div class="product-suite-image-container">
										<img class="top-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-05.png')}" />
										<img class="grey-icon under-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-gray-05.png')}" />
									</div>
									<span class="product-suite-text">WATERCRAFT</span>
								</a>
							</li>
							<li id="flood" >
								<a  href='{!floodPolicyLink}' target="_blank">
									<div class="product-suite-image-container">
										<img class="top-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-06.png')}" />
										<img class="grey-icon under-icon" src="{!URLFOR($Resource.SL_PureInsuranceResources,'images/product-suite-gray-06.png')}" />
									</div>
									<span class="product-suite-text">FLOOD</span>
								</a>
							</li>
						</ul>
						<p>PURE members who bundle their policies benefit from generous discounts and the ease and convenience of a single billing statement and one carrier to contact for all of their insurance needs. </p>
						<p><strong>Talk to your broker to learn more about these coverages. </strong></p>
					</div>
				</div>
				<c:SL_SiteFooterComponent />
			</div>
			<!-- main-content div End -->
			<script>
				if('{!member.In_Force_Homeowners_Policy__c}' == 'true')
				{
					document.getElementById('homeowners').className = 'user-owns-this-policy';
				}
				if('{!member.In_Force_Auto_Policy__c}' == 'true')
				{
					document.getElementById('auto').className = 'user-owns-this-policy';
				}
				if('{!member.In_Force_Collections_Policy__c}' == 'true')
				{
					document.getElementById('jewelry').className = 'user-owns-this-policy';
				}
				if('{!member.In_Force_Excess_Policy__c}' == 'true')
				{
					document.getElementById('personl-excess').className = 'user-owns-this-policy';
				}
				if('{!member.In_Force_Watercraft_Policy__c}' == 'true')
				{
					document.getElementById('watercraft').className = 'user-owns-this-policy';
				}
				if('{!member.In_Force_Flood_Policy__c}' == 'true')
				{
					document.getElementById('flood').className = 'user-owns-this-policy';
				}
			</script>
		</apex:define>
		<apex:define name="rightSideBar" >
			<div id="sidebar" class="span3" >
				<c:SL_SideBarComponents />
			</div>
		</apex:define>
	</apex:composition>
</apex:page>